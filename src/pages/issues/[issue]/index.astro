---
import BaseLayout from '@/layouts/BaseLayout'
import ListPosts from '@/components/ListPosts'
import PageTitle from '@/components/PageTitle'
import { getIssues, filterPostsByIssue, sluglify } from '@/utils'

export async function getStaticPaths() {
	const issues = await getIssues()

	return issues.map((issue) => ({
		params: { issue: sluglify(issue).toLowerCase() },
		props: { issue }
	}))
}

const { issue } = Astro.props

const posts = await filterPostsByIssue(issue)
---

<BaseLayout title={issue}>
	<PageTitle title={issue} />
	<ListPosts posts={posts} />
</BaseLayout>
